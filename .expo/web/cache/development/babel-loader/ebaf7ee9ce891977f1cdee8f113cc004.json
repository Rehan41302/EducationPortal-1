{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"E:\\\\React\\\\Arslan\\\\native\\\\components\\\\tutordashboard\\\\QuizUpload.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from \"react\";\nimport firebase from \"../../config/fire\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Linking from \"react-native-web/dist/exports/Linking\";\nimport * as DocumentPicker from \"expo-document-picker\";\nimport * as RNP from \"react-native-paper\";\nimport { connect } from \"react-redux\";\nimport { firestore } from \"firebase\";\n\nvar QuizUpload = function (_React$Component) {\n  _inherits(QuizUpload, _React$Component);\n\n  var _super = _createSuper(QuizUpload);\n\n  function QuizUpload() {\n    var _this;\n\n    _classCallCheck(this, QuizUpload);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      fullPath: \"\",\n      downloadURL: \"\",\n      progress: 0,\n      uploading: false\n    };\n\n    _this.pickDocumentPDF = function _callee() {\n      var res, that, getTime, storageRef, ref, fullPath, uploadTask;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(DocumentPicker.getDocumentAsync({\n                type: \"application/pdf\"\n              }));\n\n            case 3:\n              res = _context.sent;\n              console.log(\"res : \" + JSON.stringify(res));\n              console.log(\"Type : \" + res.type);\n\n              if (res.type === \"success\") {\n                _this.setState({\n                  uploading: true\n                });\n\n                that = _assertThisInitialized(_this);\n                getTime = new Date().getTime();\n                storageRef = firebase.storage().ref();\n                ref = storageRef.child(\"/quiz/\" + getTime + \"-\" + res.name);\n                fullPath = ref.fullPath;\n                uploadTask = ref.putString(res.uri, \"data_url\");\n                uploadTask.on(\"state_changed\", function (snapshot) {\n                  var progress = snapshot.bytesTransferred / snapshot.totalBytes * 100;\n                  console.log(\"Upload is \" + progress + \"% done\");\n                  that.setState({\n                    progress: Math.round(progress)\n                  });\n                }, function (error) {\n                  console.error(error.message);\n                  Alert.alert(error.message);\n                }, function () {\n                  var _that$props, _that$props$user;\n\n                  var prevQuiz = ((_that$props = that.props) == null ? void 0 : (_that$props$user = _that$props.user) == null ? void 0 : _that$props$user.quiz) || [];\n                  uploadTask.snapshot.ref.getDownloadURL().then(function (downloadURL) {\n                    var _that$props$user2;\n\n                    prevQuiz.push({\n                      uploadTime: firestore.Timestamp.now(),\n                      pdfLink: downloadURL,\n                      storageAddress: fullPath\n                    });\n                    var db = firebase.firestore();\n                    db.collection(\"tutors\").doc((_that$props$user2 = that.props.user) == null ? void 0 : _that$props$user2.id).set(_objectSpread(_objectSpread({}, that.props.user), {}, {\n                      quiz: prevQuiz\n                    })).then(function () {\n                      that.setState({\n                        uploading: false,\n                        downloadURL: downloadURL,\n                        fullPath: fullPath\n                      });\n                    }).catch(function (error) {\n                      console.error(error);\n                      Alert.alert(error.message);\n                    });\n                  }).catch(function (error) {\n                    console.error(error);\n                    Alert.alert(error.message);\n                  });\n                });\n              }\n\n              _context.next = 13;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              alert(\"Unknown Error: \" + JSON.stringify(_context.t0));\n              throw _context.t0;\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 9]], Promise);\n    };\n\n    _this.renderItem = function (_ref) {\n      var item = _ref.item,\n          index = _ref.index;\n      var createDate = new Date(item.uploadTime.seconds * 1000);\n      return React.createElement(RNP.Card, {\n        style: styles.card,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 7\n        }\n      }, React.createElement(RNP.Card.Content, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 9\n        }\n      }, React.createElement(RNP.Title, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }\n      }, \"Quiz \", index + 1, \" \"), React.createElement(RNP.Paragraph, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }\n      }, \"Uploaded: \", createDate.toLocaleTimeString(), \",\", \" \", createDate.toDateString(), \" \")), React.createElement(RNP.Card.Actions, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 9\n        }\n      }, React.createElement(RNP.Button, {\n        onPress: function onPress() {\n          return Linking.openURL(link);\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }\n      }, \"DOWNLOAD\")));\n    };\n\n    return _this;\n  }\n\n  _createClass(QuizUpload, [{\n    key: \"render\",\n    value: function render() {\n      var user = this.props.user;\n      return React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 7\n        }\n      }, React.createElement(View, {\n        style: {\n          marginVertical: 10,\n          marginHorizontal: 10\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 9\n        }\n      }, React.createElement(Button, {\n        title: this.state.uploading ? \"Uploading \" + this.state.progress + \"%\" : \"Upload New\",\n        onPress: this.pickDocumentPDF,\n        style: styles.uploadBtn,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }\n      })), (user == null ? void 0 : user.quiz) && React.createElement(FlatList, {\n        data: user.quiz,\n        renderItem: this.renderItem,\n        keyExtractor: function keyExtractor(item) {\n          return item.pdfLink;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }\n      }));\n    }\n  }]);\n\n  return QuizUpload;\n}(React.Component);\n\nvar mapStatetoProps = function mapStatetoProps(state) {\n  console.log({\n    state: state\n  });\n  return {\n    user: state.authReducer.user,\n    isAuthenticated: state.authReducer.isAuthenticated\n  };\n};\n\nexport default connect(mapStatetoProps)(QuizUpload);\nvar styles = StyleSheet.create({\n  card: {\n    marginVertical: 10\n  },\n  webview: {\n    backgroundColor: \"yellow\",\n    height: 320,\n    width: 200\n  },\n  uploadBtn: {\n    marginTop: 10,\n    flex: 1,\n    paddingVertical: 10,\n    backgroundColor: \"#4fc3f7\",\n    alignContent: \"center\"\n  },\n  btnText: {\n    color: \"#ffffff\",\n    textAlign: \"center\"\n  }\n});","map":{"version":3,"sources":["E:/React/Arslan/native/components/tutordashboard/QuizUpload.js"],"names":["React","firebase","DocumentPicker","RNP","connect","firestore","QuizUpload","state","fullPath","downloadURL","progress","uploading","pickDocumentPDF","getDocumentAsync","type","res","console","log","JSON","stringify","setState","that","getTime","Date","storageRef","storage","ref","child","name","uploadTask","putString","uri","on","snapshot","bytesTransferred","totalBytes","Math","round","error","message","Alert","alert","prevQuiz","props","user","quiz","getDownloadURL","then","push","uploadTime","Timestamp","now","pdfLink","storageAddress","db","collection","doc","id","set","catch","renderItem","item","index","createDate","seconds","styles","card","toLocaleTimeString","toDateString","Linking","openURL","link","marginVertical","marginHorizontal","uploadBtn","Component","mapStatetoProps","authReducer","isAuthenticated","StyleSheet","create","webview","backgroundColor","height","width","marginTop","flex","paddingVertical","alignContent","btnText","color","textAlign"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport firebase from \"../../config/fire\";\r\nimport {\r\n  View,\r\n  StyleSheet,\r\n  Alert,\r\n  FlatList,\r\n  Button,\r\n  Linking\r\n} from \"react-native\";\r\nimport * as DocumentPicker from \"expo-document-picker\";\r\nimport * as RNP from \"react-native-paper\";\r\nimport { connect } from \"react-redux\";\r\nimport { firestore } from \"firebase\";\r\n\r\nclass QuizUpload extends React.Component {\r\n  state = {\r\n    fullPath: \"\",\r\n    downloadURL: \"\",\r\n    progress: 0,\r\n    uploading: false\r\n  };\r\n\r\n  pickDocumentPDF = async () => {\r\n    try {\r\n      const res = await DocumentPicker.getDocumentAsync({\r\n        type: \"application/pdf\"\r\n      });\r\n      //Printing the log realted to the file\r\n      console.log(\"res : \" + JSON.stringify(res));\r\n      console.log(\"Type : \" + res.type);\r\n      if (res.type === \"success\") {\r\n        this.setState({ uploading: true });\r\n        let that = this;\r\n        let getTime = new Date().getTime();\r\n        let storageRef = firebase.storage().ref();\r\n        let ref = storageRef.child(`/quiz/${getTime}-${res.name}`);\r\n        let fullPath = ref.fullPath;\r\n        let uploadTask = ref.putString(res.uri, \"data_url\");\r\n        // New Addintion\r\n        uploadTask.on(\r\n          \"state_changed\",\r\n          function(snapshot) {\r\n            // Observe state change events such as progress, pause, and resume\r\n            // Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded\r\n            var progress =\r\n              (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n            console.log(\"Upload is \" + progress + \"% done\");\r\n            that.setState({\r\n              progress: Math.round(progress)\r\n            });\r\n          },\r\n          function(error) {\r\n            // Handle unsuccessful uploads\r\n            console.error(error.message);\r\n            Alert.alert(error.message);\r\n          },\r\n          function() {\r\n            // Handle successful uploads on complete\r\n            let prevQuiz = that.props?.user?.quiz || [];\r\n            uploadTask.snapshot.ref\r\n              .getDownloadURL()\r\n              .then(function(downloadURL) {\r\n                prevQuiz.push({\r\n                  uploadTime: firestore.Timestamp.now(),\r\n                  pdfLink: downloadURL,\r\n                  storageAddress: fullPath\r\n                });\r\n                const db = firebase.firestore();\r\n                db.collection(\"tutors\")\r\n                  .doc(that.props.user?.id)\r\n                  .set({\r\n                    ...that.props.user,\r\n                    quiz: prevQuiz\r\n                  })\r\n                  .then(() => {\r\n                    that.setState({\r\n                      uploading: false,\r\n                      downloadURL,\r\n                      fullPath\r\n                    });\r\n                  })\r\n                  .catch(error => {\r\n                    console.error(error);\r\n                    Alert.alert(error.message);\r\n                  });\r\n              })\r\n              .catch(error => {\r\n                console.error(error);\r\n                Alert.alert(error.message);\r\n              });\r\n          }\r\n        );\r\n      }\r\n    } catch (err) {\r\n      alert(\"Unknown Error: \" + JSON.stringify(err));\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  renderItem = ({ item, index }) => {\r\n    let createDate = new Date(item.uploadTime.seconds * 1000);\r\n\r\n    return (\r\n      <RNP.Card style={styles.card}>\r\n        <RNP.Card.Content>\r\n          <RNP.Title>Quiz {index + 1} </RNP.Title>\r\n          <RNP.Paragraph>\r\n            Uploaded: {createDate.toLocaleTimeString()},{\" \"}\r\n            {createDate.toDateString()}{\" \"}\r\n          </RNP.Paragraph>\r\n          {/* <Paragraph>Time & Date</Paragraph> */}\r\n        </RNP.Card.Content>\r\n        {/* <Card.Cover source={{ uri: \"https://picsum.photos/700\" }} /> */}\r\n        <RNP.Card.Actions>\r\n          <RNP.Button onPress={() => Linking.openURL(link)}>\r\n            DOWNLOAD\r\n          </RNP.Button>\r\n        </RNP.Card.Actions>\r\n      </RNP.Card>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    let { user } = this.props;\r\n    // console.log({ user });\r\n    return (\r\n      <View>\r\n        <View style={{ marginVertical: 10, marginHorizontal: 10 }}>\r\n          <Button\r\n            title={\r\n              this.state.uploading\r\n                ? `Uploading ${this.state.progress}%`\r\n                : \"Upload New\"\r\n            }\r\n            onPress={this.pickDocumentPDF}\r\n            style={styles.uploadBtn}\r\n          />\r\n        </View>\r\n        {user?.quiz && (\r\n          // <SafeAreaView>\r\n          <FlatList\r\n            data={user.quiz}\r\n            renderItem={this.renderItem}\r\n            keyExtractor={item => item.pdfLink}\r\n          />\r\n          // {/* </SafeAreaView> */}\r\n        )}\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStatetoProps = state => {\r\n  console.log({ state });\r\n  return {\r\n    user: state.authReducer.user,\r\n    isAuthenticated: state.authReducer.isAuthenticated\r\n  };\r\n};\r\nexport default connect(mapStatetoProps)(QuizUpload);\r\n\r\nconst styles = StyleSheet.create({\r\n  card: {\r\n    marginVertical: 10\r\n  },\r\n  webview: {\r\n    backgroundColor: \"yellow\",\r\n    height: 320,\r\n    width: 200\r\n  },\r\n  uploadBtn: {\r\n    marginTop: 10,\r\n    flex: 1,\r\n    paddingVertical: 10,\r\n    backgroundColor: \"#4fc3f7\",\r\n    alignContent: \"center\"\r\n  },\r\n  btnText: {\r\n    color: \"#ffffff\",\r\n    textAlign: \"center\"\r\n    // fontWeight: 500\r\n  }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}